% sagar-exam-core.sty
% Common exam layout, geometry, and tcolorbox setup
% for Sagar's ICSE/ISC exams and class tests
% Copyright (c) 2025 Sagar Tamhankar
% MIT License â€“ see LICENSE file in repository
% Repository: https://github.com/sagart23/latex-styles-sagar.git
% --------------------------------------------------

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{sagar-exam-core}[2025/11/23 v1.1 Sagar exam core style]

% --------------------------------------------------
% Core encoding & fonts
% --------------------------------------------------
\RequirePackage[T1]{fontenc}
\RequirePackage{lmodern}

% --------------------------------------------------
% Typography & microtype
% --------------------------------------------------
\RequirePackage[final]{microtype}
\microtypesetup{
    protrusion = true,
    expansion  = true
}
\UseMicrotypeSet[protrusion]{basicmath}

% --------------------------------------------------
% Spacing package (for \doublespacing, \onehalfspacing)
% --------------------------------------------------
\RequirePackage{setspace}

% --------------------------------------------------
% Exam-specific geometry
% --------------------------------------------------
\RequirePackage[
    left        = 2cm,
    right       = 2cm,
    top         = 2.5cm,
    bottom      = 2.5cm,
    headheight  = 25pt,
    headsep     = 0.8cm,
    footskip    = 0.8cm
]{geometry}

% --------------------------------------------------
% FIXED: Now properly loads tcolorbox
% (Colors are inherited from sagar-boxes.sty)
% --------------------------------------------------
\RequirePackage[most,breakable]{tcolorbox}
\tcbuselibrary{skins}

% --------------------------------------------------
% Exam class customizations (for exam.cls)
% --------------------------------------------------
% Professional question formatting
\@ifclassloaded{exam}{%
    \renewcommand{\questionlabel}{\sffamily\bfseries Q.\thequestion}
    \renewcommand{\partlabel}{\sffamily\bfseries(\thepartno)}
    \renewcommand{\subpartlabel}{\sffamily\bfseries\thesubpart.}
    
    % Enhanced point display
    \pointsdroppedatright
    \marksnotpoints
    \pointformat{\sffamily\bfseries[\themarginpoints]}
    \setlength{\rightpointsmargin}{2.5cm}
}{}

% --------------------------------------------------
% Notes:
% - Colors are defined in sagar-boxes.sty (loaded first)
% - Watermark settings left to document preamble
% - Headers/footers configured per-document
% - tcolorbox environments for exams should be defined
%   in sagar-exam-extended.sty to keep this core lean
%
% End of sagar-exam-core.sty
% --------------------------------------------------
\endinput